OBJS = functions.o Basis_1orb_SF.o Model_1orb_SF.o Spin_dynamics_ED_engine.o Spin_dynamics_VNE_engine.o  main.o
DEBUG = #-g3
OPTFLAG = -O3
CC = icc $(OPTFLAG)
CFLAGS = -c $(DEBUG) #-DWITH_COMPLEX
LFLAGS = $(DEBUG)
MKL_LIB = #/opt/intel/mkl/lib/libmkl_core.a  /opt/intel/mkl/lib/libmkl_intel_lp64.a /opt/intel/mkl/lib/libmkl_sequential.a
MKL_LIB += -ldl -lpthread -lm
MKL_LIB2 = -lmkl_intel_lp64 -lmkl_core -lmkl_intel_thread
MKL_include = #-I/opt/intel/mkl/include
OPENMP = #/opt/intel/compilers_and_libraries_2016.3.170/mac/compiler/lib/
LIBS_1 =  #-L$(OPENMP)
LIBS_1 += -qopenmp -liomp5
 

all :	$(OBJS) 
	$(CC) $(LFLAGS) $(OBJS) -o dynamics $(MKL_include) $(MKL_LIB2) $(MKL_LIB) $(LIBS_1)

functions.o : functions.h functions.cpp
	$(CC) $(CFLAGS) functions.cpp $(MKL_include) $(MKL_LIB) $(LIBS_1)

Basis_1orb_SF.o : tensor_type.h functions.h Basis_1orb_SF.h Basis_1orb_SF.cpp
	$(CC) $(CFLAGS) Basis_1orb_SF.cpp $(MKL_include) $(MKL_LIB) $(LIBS_1)

Model_1orb_SF.o : tensor_type.h functions.h Model_1orb_SF.h Model_1orb_SF.cpp
	$(CC) $(CFLAGS) Model_1orb_SF.cpp $(MKL_include) $(MKL_LIB) $(LIBS_1)

Spin_dynamics_ED_engine.o : tensor_type.h functions.h Basis_1orb_SF.h Model_1orb_SF.h Spin_dynamics_ED_engine.h Spin_dynamics_ED_engine.cpp
	$(CC) $(CFLAGS) Spin_dynamics_ED_engine.cpp $(MKL_include) $(MKL_LIB) $(LIBS_1)

Spin_dynamics_VNE_engine.o : tensor_type.h functions.h Basis_1orb_SF.h Model_1orb_SF.h Spin_dynamics_VNE_engine.h Spin_dynamics_VNE_engine.cpp
	$(CC) $(CFLAGS) Spin_dynamics_VNE_engine.cpp $(MKL_include) $(MKL_LIB) $(LIBS_1)

main.o : tensor_type.h functions.h Basis_1orb_SF.h Model_1orb_SF.h Spin_dynamics_ED_engine.h Spin_dynamics_VNE_engine.h  main.cpp
	$(CC) $(CFLAGS) main.cpp $(MKL_include) $(MKL_LIB) $(LIBS_1)

clean:
	rm *.o dynamics
